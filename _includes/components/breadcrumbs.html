{%- comment -%}
  Include as: {%- include components/breadcrumbs.html -%}
  Depends on: page, site.
  Results in: HTML for the breadcrumbs component.
  Overwrites:
    pages_list, parent_page, grandparent_page.
{%- endcomment -%}

{%- if page.url != "/" and page.parent -%}

  {%- assign pages_list = site[page.collection]
      | default: site.html_pages
      | where_exp: "item", "item.title != nil"
      | where_exp: "item", "item.has_children != nil" -%}

  {%- if page.grand_parent -%}
    {%- assign parent_page = pages_list
        | where: "title", page.parent
        | where: "parent", page.grand_parent
        | first -%}
    {%- assign grandparent_page = pages_list
        | where: "title", page.grand_parent
        | first -%}
  {%- else -%}
    {%- assign parent_page = pages_list
        | where: "title", page.parent
        | where_exp: "item", "item.parent == nil"
        | first -%}
  {%- endif -%}

<nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
  {% if page.parent -%}
  {%- if page.grand_parent %}
    <li class="breadcrumb-nav-list-item"><a href="{{ grandparent_page.url | relative_url }}">{{ page.grand_parent }}</a></li>
  {%- endif %}
    <li class="breadcrumb-nav-list-item"><a href="{{ parent_page.url | relative_url }}">{{ page.parent }}</a></li>
  {% endif -%}
    <li class="breadcrumb-nav-list-item"><span>{{ page.title }}</span></li>
  </ol>
</nav>

{%- endif -%}

<div class="main-content">
  <h1>
    {{page.title}}
  </h1>
{%- comment -%}
  Include as: {%- include components/children_nav.html -%}
  Depends on: page, site.
  Results in: HTML for the children-navigation component.
  Includes:
    sorted_pages.html
    toc_heading_custom.html
  Overwrites:
    child_pages.
{%- endcomment -%}

{%- if page.has_children == true and page.has_toc != false -%}
  {%- assign child_pages = site[page.collection]
        | default: site.html_pages
        | where: "parent", page.title
        | where: "grand_parent", page.parent -%}

  {%- include sorted_pages.html pages = child_pages -%}

  {%- if page.child_nav_order == 'desc' or page.child_nav_order == 'reversed' -%}
    {%- assign sorted_pages = sorted_pages | reverse -%}
  {%- endif -%}
{%- endif -%}

<ul>
{% for child in sorted_pages %}
  <li>
    <a href="{{ child.url | relative_url }}">{{ child.title }}</a>{% if child.summary %} - {{ child.summary }}{% endif %}
  </li>
{% endfor %}
</ul>
</div>
